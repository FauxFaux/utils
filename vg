#!/bin/bash

# $Id$
# File ID: 58ece940-08f3-11de-ab14-000475e441b9

cmdl=$*
uuid=`suuid -w eo -t vg -c "vg $*"` || { echo vg: suuid error >&1; exit 1; }
if [ "$1" = "-t" ]; then
    shift
    (echo "# Session ID: $uuid"; gpst -o csv -rt -e -d -t "$@") | rmspcall | uniq >/tmp/vg-t.tmp
    cat <<END >/tmp/vg-t-cmd.tmp
# Session ID: $uuid
set mouse
# load "/tmp/label.gnuplot"
set zdata time
# set timefmt "%Y-%m-%dT%H:%M:%SZ"
set timefmt "%s"
splot "/tmp/vg-t.tmp" using 2:3:1 w l palette
pause -1 "Trykk Enter..."
END
    gnuplot -persist /tmp/vg-t-cmd.tmp
else
    (echo "# Session ID: $uuid"; gpst -o clean -ret -d -t "$@") | rmspcall | uniq >/tmp/vg.tmp
    cat <<END >/tmp/vg-cmd.tmp
# Session ID: $uuid
set mouse
# load "/tmp/label.gnuplot"
splot "/tmp/vg.tmp" w l palette
pause -1 "Trykk Enter..."
END
    gnuplot -persist /tmp/vg-cmd.tmp
fi
